<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brand Memorability POC</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
  <div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-4 text-center">Brand Memorability POC</h1>

    <!-- Home Analysis Form -->
    <form method="POST" action="/" class="bg-white p-4 rounded shadow mb-6">
      <label for="url" class="block mb-2 font-medium">Website URL:</label>
      <input type="text"
             name="url"
             id="url"
             placeholder="https://example.com"
             class="w-full border rounded px-3 py-2 mb-3"
             required
             autofocus>
      <button type="submit"
              class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">
        Analyze
      </button>
      {% if error %}
        <p class="mt-3 text-red-600">{{ error }}</p>
      {% endif %}
    </form>

    <!-- Single-Site Analysis Results -->
    {% if visual and cognitive %}
      <div class="bg-white p-6 rounded shadow mb-8">
        <!-- Visual Section -->
        <div class="mb-6">
          <h2 class="text-2xl font-semibold mb-2">
            Visual Distinctiveness Score:
            <span class="text-blue-600">{{ visual.score }}/10</span>
          </h2>
          {% if visual.summary %}
            <p class="text-gray-700 italic mb-4">{{ visual.summary }}</p>
          {% endif %}
          {% if visual.screenshot %}
            <img src="/static/{{ visual.screenshot }}"
                 alt="Screenshot"
                 class="mb-4 w-full rounded border">
          {% endif %}

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {% for key, val in visual.breakdown.items() %}
              {% if key in ['Dominant Colours','Dominant Colors'] %}
                <div>
                  <h3 class="font-semibold mb-2">{{ key }}:</h3>
                  <div class="flex gap-4">
                    {% for swatch in val %}
                      <div class="text-center">
                        <div class="w-10 h-10 rounded-full border shadow"
                             style="background-color: {{ swatch.hex }};">
                        </div>
                        <div class="text-xs mt-1">{{ swatch.percentage }}%</div>
                      </div>
                    {% endfor %}
                  </div>
                </div>
              {% else %}
                <div>
                  <h3 class="font-semibold">{{ key }}:</h3>
                  <p>{{ val }}</p>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>

        <!-- Cognitive Section -->
        <div class="mb-6">
          <h2 class="text-2xl font-semibold mb-2">
            Cognitive Load Score:
            <span class="text-green-600">{{ cognitive.cognitive_load_score }}/10</span>
          </h2>
          <ul class="list-disc list-inside text-gray-700">
            <li>Readability: {{ cognitive.readability_score }}/10</li>
            <li>Information Density: {{ cognitive.density_score }}/10</li>
            <li>Complexity: {{ cognitive.complexity_score }}/10</li>
            <li>Hierarchy Clarity: {{ cognitive.hierarchy_score }}/10</li>
          </ul>
          {% if cognitive.feedback %}
            <div class="bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 p-4 mt-4 rounded">
              <ul class="list-disc list-inside text-sm">
                {% for note in cognitive.feedback %}
                  <li>{{ note }}</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}
        </div>

        <!-- Combined Note -->
        <p class="text-sm italic text-gray-600">
          Combined analysis represents 33% of our full memorability assessment
        </p>
      </div>
    {% endif %}

    <!-- Recent History -->
    {% if history %}
      <div class="mt-8">
        <h2 class="text-xl font-bold mb-4">Recent Analyses</h2>
        <ul class="space-y-4 text-sm">
          {% for row in history %}
            <li class="bg-white p-4 rounded shadow">
              <div class="font-medium">{{ row[0] }}</div>
              <div>Visual Score: <span class="font-semibold">{{ row[1] }}/10</span></div>
              <div>Cognitive Load: <span class="font-semibold">{{ row[4] }}/10</span></div>
              <div class="italic text-gray-700 mt-1">{{ row[2] }}</div>
              <div class="text-gray-500 text-xs mt-1">
                {{ row[3][:19].replace("T", " ") }}
              </div>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </div>
</body>
</html>
